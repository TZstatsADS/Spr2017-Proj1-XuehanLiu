---
title: "GR5243 Project 1 by Xuehan Liu (xl2615)"
output: html_notebook
---

####Introduction
The president election in the US has been the hottest topic in the past few months. The competition between Repbulican party and Democratic party is accelerated. In order to understands more about Repbulican and Democratic, we will looking at the inaugural speeches that given by previous presidents from these two parties. There will be two major questions we can answer with this project: 1) Do Repbulican and Democratic focus on different aspects? and 2) For those who are considered as typical representative for each party, what sentiments they carries in their inaugural speeches? With the answer to both questions, we will have a deeper understanding of both the Repbulican and Democratic parties' philosophy. 

###Laoding data, packages and cleaning up
Before we are doing any further analysis, we load relative packages and our text file into R.
```{r, message=FALSE, warning=FALSE}
packages.used=c("rvest", "tibble", "qdap", 
                "sentimentr", "gplots", "dplyr",
                "tm", "syuzhet", "factoextra", 
                "beeswarm", "scales", "RColorBrewer",
                "RANN", "tm", "topicmodels")

# check packages that need to be installed.
packages.needed=setdiff(packages.used, 
                        intersect(installed.packages()[,1], 
                                  packages.used))
# install additional packages
if(length(packages.needed)>0){
  install.packages(packages.needed, dependencies = TRUE)
}

# load packages
library("rvest")
library("tibble")
library("qdap")
library("sentimentr")
library("gplots")
library("dplyr")
library("tm")
library("syuzhet")
library("factoextra")
library("beeswarm")
library("scales")
library("RColorBrewer")
library("RANN")
library("tm")
library("topicmodels")

#source("../lib/plotstacked.R")
#source("../lib/speechFuncs.R")


inaug.list<-read.csv("/Users/xuehan/Desktop/5243 ADS/Spr2017-Proj1-XuehanLiu/data/inauglist.csv", stringsAsFactors = FALSE)
nomin.list<-read.csv("/Users/xuehan/Desktop/5243 ADS/Spr2017-Proj1-XuehanLiu/data/nominlist.csv", stringsAsFactors = FALSE)
farewell.list<-read.csv("/Users/xuehan/Desktop/5243 ADS/Spr2017-Proj1-XuehanLiu/data/farewelllist.csv", stringsAsFactors = FALSE)
speech.list=rbind(inaug.list, nomin.list, farewell.list)
speech.list$type=c(rep("inaug", nrow(inaug.list)),
                   rep("nomin", nrow(nomin.list)),
                   rep("farewell", nrow(farewell.list)))
speech.url=rbind(inaug.list, nomin.list, farewell.list)
speech.list=cbind(speech.list, speech.url)
```


###Load the speeches:
```{r}
#Load the speeches:
folder.path<-file.path("/Users/xuehan/Desktop/5243 ADS/Spr2017-Proj1-XuehanLiu/data/InauguralSpeeches/")
#speeches<-list.files(path = folder.path, pattern = "*.txt")
text<-Corpus(DirSource(folder.path))
```

###Check whether Repbulican and Democratic are indeed domain the political parties in the US. 

As we all know, Republican and Democratic are the two biggest parties in the America. So our focus is going to be at these parties. Before jump into the conclusion stated directly, we can use some graph and numerical tool to confirm this statement.  

```{r}
library(ggplot2)
speech.list$Party<-as.factor(speech.list$Party)
speech.list$Win<-as.factor(speech.list$Win)
levels(speech.list$Win)[1]<-"No"
levels(speech.list$Win)[2]<-"Yes"
ggplot(aes(x=Win,fill=Party),data=speech.list)+geom_bar(position="fill")+scale_fill_brewer(palette="Set1")+xlab("Winning Presidency")+ylab("Percent")+coord_flip()+theme_bw()+ggtitle("Figure1: Propotion of Winning Presidency")+theme(plot.title=element_text(lineheight=.8))
table(as.factor(inaug.list$Party))/length(inaug.list$Party)
```

From this Mosaic plot, we can see those presidents who won presidency, most of them are from Republican Party. This idea is also supported by the table summary above. So from now on, our analysis can only be about Republican and Democratic. 

####Question 1: Do Repbulican and Democratic focus on different aspects? 

```{r}
library(tm)
library(RColorBrewer)
library(wordcloud)
library(dplyr)
library(tidytext)

text <- tm_map(text, content_transformer(tolower))
text<-tm_map(text, removeWords, stopwords("english"))
text <- tm_map(text, stripWhitespace)
text <- tm_map(text, removeWords, character(0))
text<-tm_map(text, removePunctuation)
text <- tm_map(text, PlainTextDocument) 

#Check the overall wordcloud first:
wordcloud(text,random.order=F,scale=c(3,0.5),max.word=40,colors=rainbow(40))
```
One thing we can use the overall wordcloud for is to continue removing unuseful words in the speeches. Based on the wordcloud above, we probably should eliminate words like will,people, government,shall, may, must, made, world,etc. We can repeat this steps many times and choose the most useful set of words to you. 

```{r}
#remove unuseful words mentioned above
text<-tm_map(text, removeWords, c("will","people", "government","shall", "may", "must","made", "world","can","every","country","now","good","upon","states","nation","nations","america","great","national","rights","one","let","new","the","make","without","american","well","time","among","know","years","just","many"))
wordcloud(text,random.order=F,scale=c(3,0.5),max.word=30,colors=rainbow(40))
```

From the above wordcloud image, most of the words actually make sense.So we can start the comparison for Republican party and Democratic party from here.

```{r}
#Extract speeches for Democratic
#First find presidents who are Democratic:
demop<-inaug.list[which(inaug.list$Party=="Democratic"),]$President
#length(demop)
#Totally there should be 22 presidents
demo<-text[c(3:6,12:16,22:24,26,28,33,35,37,38,52,53,56,57)]

#Extract speeches for Republican 
repp<-inaug.list[which(inaug.list$Party=="Republican"),]$President
repub<-text[c(1,2,7:11,17,20,21,25,27,39:44,47:49,51,54,55)]

#Check out the wordcloud of most frequent words for Democratic
wordcloud(demo,random.order=F,scale=c(3,0.5),max.word=30,colors=rainbow(40))
wordcloud(repub,random.order=F,scale=c(3,0.5),max.word=30,colors=rainbow(40))
```

Looking at the those two wordcloud above, we can see the some of the Republican's most frequent words are "peace", "freedom", "united", and "spirit"; while the Democratic's are more about "constitution", "justice", "principles" and "power". This results are consistant with the political philosophies of these parties: Republican is liberal, who will care more about the humanism; while the Democratic is conservative, who will control the country in a way that relies on the rules. 

####Question 2: for those who are considered as "best" (representative) presidents in the history, what sentiments they carries in their speeches?

According to the article published in the website mademan.com, (http://www.mademan.com/mm/5-best-democratic-presidents.html) and (http://www.mademan.com/mm/5-best-republican-presidents.html), we choose five presidents for each party, listed as following: 

Repubilican: Abraham Lincoln, Ulysses S. Grant, Theodore Roosevelt, Dwight D. Eisenhower, Ronald Reagan

Democratic: Franklin D. Roosevelt, Woodrow Wilson, Andrew Jackson, Harry S. Truman, and John F. Kennedy

We will study the inaugural speeches from these ten presidents and conduct the sentiment analysis. 

###Generate sentences list by code given in the prof. Zheng's tutorial 2:
```{r, message=FALSE, warning=FALSE}
sentence.list=NULL
for(i in 1:nrow(speech.list)){
  sentences=sent_detect(speech.list$fulltext[i],
                        endmarks = c("?", ".", "!", "|",";"))
  if(length(sentences)>0){
    emotions=get_nrc_sentiment(sentences)
    word.count=word_count(sentences)
    # colnames(emotions)=paste0("emo.", colnames(emotions))
    # in case the word counts are zeros?
    emotions=diag(1/(word.count+0.01))%*%as.matrix(emotions)
    sentence.list=rbind(sentence.list, 
                        cbind(speech.list[i,-ncol(speech.list)],
                              sentences=as.character(sentences), 
                              word.count,
                              emotions,
                              sent.id=1:length(sentences)
                              )
    )
  }
}

sentence.list=sentence.list%>%filter(!is.na(word.count))
```



```{r}
#Creat a subset that contains five Repubilican presidents mentioned above
#FiveRepub<- sentence.list[sentence.list$President==c("Abraham Lincoln","Ulysses S. Grant","Theodore Roosevelt","Dwight D. Eisenhower","Ronald Reagan"),13:22]

#Extract sentiment score for five presidents:
AL<-na.omit(sentence.list[which(sentence.list$President=="Abraham Lincoln"),13:22])
UG<-na.omit(sentence.list[which(sentence.list$President=="Ulysses S. Grant"),13:22])
TR<-na.omit(sentence.list[which(sentence.list$President=="Theodore Roosevelt"),13:22])
DE<-na.omit(sentence.list[which(sentence.list$President=="Dwight D. Eisenhower"),13:22])
RR<-na.omit(sentence.list[which(sentence.list$President=="Ronald Reagan"),13:22])


#Average sentiment scores for five presidents:
als<-apply(AL,2,mean)
ugs<-apply(UG,2,mean)
trs<-apply(TR,2,mean)
des<-apply(DE,2,mean)
rrs<-apply(RR,2,mean)

#Then we can record this information in a speard sheet in Excel for future use. 

#FiveRepub<-cbind(data.frame(apply(AL,2,mean)),data.frame(apply(UG,2,mean)),data.frame(apply(TR,2,mean)),data.frame(apply(DE,2,mean)),data.frame(apply(RR,2,mean)))
#colnames(FiveRepub)<-c("Abraham Lincoln","Ulysses S. Grant","Theodore Roosevelt","Dwight D. Eisenhower","Ronald Reagan")

#Repeat the same step as above for five Democratic Presidents:
FR<-na.omit(sentence.list[which(sentence.list$President=="Franklin D. Roosevelt"),13:22])
WW<-na.omit(sentence.list[which(sentence.list$President=="Woodrow Wilson"),13:22])
AJ<-na.omit(sentence.list[which(sentence.list$President=="Andrew Jackson"),13:22])
HT<-na.omit(sentence.list[which(sentence.list$President=="Harry S. Truman"),13:22])
JK<-na.omit(sentence.list[which(sentence.list$President=="John F. Kennedy"),13:22])

frs<-apply(FR,2,mean)
wws<-apply(WW,2,mean)
ajs<-apply(AJ,2,mean)
hts<-apply(HT,2,mean)
jks<-apply(JK,2,mean)

#Load the sentiment score data:
sscore<-read.csv("/Users/xuehan/Desktop/5243 ADS/Spr2017-Proj1-XuehanLiu/data/sentiment score.csv")
sscore$score<-as.numeric(sscore$score)
sscore$type<-as.factor(sscore$type)
sscore$party<-as.factor(sscore$party)
sscore$President<-as.factor(sscore$President)

#Plot of those sentiments scores:
ggplot(data=sscore,aes(x=type,y=score,colour=party,group=President))+
  geom_point()+geom_line()+ggtitle("Figure2.Sentiment Score for Ten Presidents")+theme_bw()+labs(x="Emotions",y="Emotion Scores")


```





